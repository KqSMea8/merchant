webpackJsonp([3],{1e3:function(e,t,i){"use strict";(function(e){function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i(100),a=o(n),s=i(229),r=o(s);t.default={name:"multiupload",data:function(){return{ViewImgUrl:"",visible:!1,uploadList:[],defaultList:[],newFile:"",uploadName:"image",otherFormData:{ssid:a.default.get("ssid")}}},props:["imagesList","uploadAPI","removeAPI"],methods:{handleView:function(e){this.ViewImgUrl=e.url,this.visible=!0},handleRemove:function(t){var i=this,o=this;e.ajax({url:o.removeAPI,type:"POST",dataType:"json",data:{ssid:a.default.get("ssid"),imageId:t.id}}).done(function(e){if(e)if(0==e.code){var o=i.uploadList;i.uploadList.splice(o.indexOf(t),1)}else r.default.showError({vm:i,data:e,errorMsg:""});else r.default.showError({vm:i,data:e,errorMsg:"请求失败"})}).fail(function(e,t,o){r.default.showError({vm:i,data:data,errorMsg:"服务器通讯失败"})})},handleSuccess:function(e,t,i){t.name="images-"+e.data,this.uploadList=this.$refs.upload.fileList,this.uploadList[this.uploadList.length-1].url=this.newFile,this.uploadList[this.uploadList.length-1].id=e.data},handleFormatError:function(e){this.$Notice.warning({title:"文件格式不正确",desc:"文件 "+e.name+" 格式不正确,请选择图片文件。"})},handleMaxSize:function(e){this.$Notice.warning({title:"文件过大",desc:"上传文件："+e.name+" 过大，请不要超过"+this.bytesToSize(1024*this.file_infro.maxSize)})},handleBeforeUpload:function(e){var t=this,i=this.uploadList.length<5;if(!i)return this.$Notice.warning({title:"最多只能上传5张图片"}),!1;if(window.FileReader&&e){var o=new FileReader;o.onloadend=function(e){t.newFile=e.target.result},o.readAsDataURL(e)}return i},bytesToSize:function(e){if(0===e)return"0 B";var t=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,i)).toPrecision(3)+" "+t[i]}},mounted:function(){this.uploadList=this.$refs.upload.fileList}}}).call(t,i(230))},1005:function(e,t){},1006:function(e,t,i){i(1005);var o=i(65)(i(1e3),i(1007),null,null);o.options.__file="E:\\BigCousin\\document\\预购宝\\merchant\\src\\views\\my_components\\upload\\multiupload.vue",o.esModule&&Object.keys(o.esModule).some(function(e){return"default"!==e&&"__esModule"!==e})&&console.error("named exports are not supported in *.vue files."),o.options.functional&&console.error("[vue-loader] multiupload.vue: functional components are not supported with templates, they should use render functions."),e.exports=o.exports},1007:function(e,t,i){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"multiupload"},[e._l(e.uploadList,function(t){return i("div",{staticClass:"uploads-upload-list"},["finished"===t.status?[i("img",{attrs:{src:t.url}}),e._v(" "),i("div",{staticClass:"uploads-upload-list-cover"},[i("Icon",{attrs:{type:"ios-eye-outline"},nativeOn:{click:function(i){e.handleView(t)}}}),e._v(" "),i("Icon",{attrs:{type:"ios-trash-outline"},nativeOn:{click:function(i){e.handleRemove(t)}}})],1)]:[t.showProgress?i("Progress",{attrs:{percent:t.percentage,"hide-info":""}}):e._e()]],2)}),e._v(" "),i("Upload",{ref:"upload",staticStyle:{display:"inline-block",width:"58px"},attrs:{"show-upload-list":!1,"default-file-list":e.imagesList,"on-success":e.handleSuccess,format:["jpg","jpeg","png"],"max-size":2048,data:e.otherFormData,"on-format-error":e.handleFormatError,"on-exceeded-size":e.handleMaxSize,"before-upload":e.handleBeforeUpload,multiple:"",type:"drag",action:e.uploadAPI,name:e.uploadName}},[i("div",{staticStyle:{width:"58px",height:"58px","padding-top":"10px","line-height":"18px",color:"#999"}},[i("Icon",{attrs:{type:"ios-cloud-upload-outline",size:"20"}}),i("br"),e._v("上传图片\n        ")],1)]),e._v(" "),i("Modal",{attrs:{title:"图片预览"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[e.visible?i("img",{staticStyle:{width:"100%"},attrs:{src:e.ViewImgUrl}}):e._e()])],2)},staticRenderFns:[]},e.exports.render._withStripped=!0},1039:function(e,t,i){"use strict";(function(e){function o(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var n=i(154),a=o(n),s=i(100),r=o(s),l=i(229),u=o(l),d=i(998),p=o(d),c=i(1006),m=o(c);t.default={name:"settings-shopinfro",components:{noUpFileInput:p.default,multiupload:m.default},data:function(){return{uploadAPI:u.default.api.setting.shopInfro.multiUpload,removeAPI:u.default.api.setting.shopInfro.removeImage,userForm:{information:"",shop_logo:{url:"",file:"",fileObj:"file_shopLogo",fileObjName:"店铺照片",uploadMenu:"选择图片",uploadType:"sync",type:"image",maxSize:2048},shopImages:[],isImagesListDataReady:!1,Point:{lat:34.275993,lng:108.953924,address:"西安市"},newPoint:{lat:0,lng:0,address:""}},map:{},userTypeList:[{value:-1,label:"未知"}],upLoadingshopLogo:!1,upLoadingshopImages:!1,FormSubmiting:!1,save_loading:!1,inforValidate:{}}},methods:{cancelEditUserInfor:function(){this.$store.commit("removeTag","settings-userinfro"),localStorage.pageOpenedList=(0,a.default)(this.$store.state.pageOpenedList);var e="";e=this.$store.state.pageOpenedList.length>1?this.$store.state.pageOpenedList[1].name:this.$store.state.pageOpenedList[0].name,this.$router.push({name:e})},saveEdit:function(){var t=this;this.$refs.userForm.validate(function(i){if(i){t.FormSubmiting=!0;var o=new FormData;o.append("ssid",r.default.get("ssid")),o.append("lng",t.userForm.newPoint.lng||t.userForm.Point.lng),o.append("lat",t.userForm.newPoint.lat||t.userForm.Point.lat),o.append("logo",t.userForm.shop_logo.file),o.append("description",t.userForm.information),t.userForm.shop_logo.file&&o.append("logo",t.userForm.shop_logo.file),e.ajax({url:u.default.api.setting.shopInfro.update,type:"POST",dataType:"json",data:o,cache:!1,contentType:!1,processData:!1}).done(function(e){t.FormSubmiting=!1,e?0==e.code?(t.$Message.success("成功保存基本信息！"),t.setMapCenter(t.userForm.newPoint.lng||t.userForm.Point.lng,t.userForm.newPoint.lat||t.userForm.Point.lat)):u.default.showError({vm:t,data:e,errorMsg:""}):u.default.showError({vm:t,data:e,errorMsg:"请求失败"})}).fail(function(e,i,o){t.FormSubmiting=!1,u.default.showError({vm:t,data:data,errorMsg:"服务器通讯失败"})})}})},clearAddress:function(){this.userForm.newPoint.lat=0,this.userForm.newPoint.lng=0,this.userForm.newPoint.address=""},setBMap:function(){function e(){function e(){var e=i.getResults().getPoi(0).point;n.userForm.newPoint.lat=e.lat,n.userForm.newPoint.lng=e.lng,t.centerAndZoom(e,16),t.addOverlay(new BMap.Marker(e))}t.clearOverlays();var i=new BMap.LocalSearch(t,{onSearchComplete:e});i.search(s)}var t=this.map=new BMap.Map("allmap"),i=new BMap.Geocoder,o=new BMap.Point(this.userForm.Point.lng,this.userForm.Point.lat);t.centerAndZoom(o,14),t.addOverlay(new BMap.Marker(o)),t.enableScrollWheelZoom(!0);var n=this;t.addEventListener("click",function(e){t.clearOverlays();var o=e.point;i.getLocation(o,function(e){var t=e.addressComponents,i=t.province+""+t.city+t.district+" "+t.street+" "+t.streetNumber;n.userForm.newPoint.address=i}),n.userForm.newPoint.lat=e.point.lat,n.userForm.newPoint.lng=e.point.lng;var a=new BMap.Marker(new BMap.Point(e.point.lng,e.point.lat));t.addOverlay(a)});var a=new BMap.Autocomplete({input:"suggestId",location:t,onSearchComplete:function(e){}});a.addEventListener("onhighlight",function(e){});var s;a.addEventListener("onconfirm",function(t){var i=t.item.value;s=i.province+i.city+i.district+i.street+i.business,n.userForm.newPoint.address=s,e()})},setMapCenter:function(e,t){this.map.clearOverlays();var i=new BMap.Point(e,t);this.map.centerAndZoom(i,14),this.map.addOverlay(new BMap.Marker(i))},init:function(){var t=this,i=function(e){if(t.savePassLoading=!1,e)if(0==e.code){t.userForm.shop_logo.url=e.data.merchantLogo||"";var i=[];e.data.merchantImages.forEach(function(e,t){i.push({name:"item"+t,url:e.image,id:e.id,merchant_id:e.merchant_id,status:"finished"})}),t.userForm.shopImages=i,t.userForm.Point.lat=e.data.merchantLat||"34.275993",t.userForm.Point.lng=e.data.merchantLng||"108.953924",t.userForm.Point.address=e.data.address||"西安市",t.userForm.information=e.data.merchantDescription,t.setMapCenter(t.userForm.Point.lng,t.userForm.Point.lat),t.userForm.isImagesListDataReady=!0}else u.default.showError({vm:t,data:e,errorMsg:""});else u.default.showError({vm:t,data:e,errorMsg:"数据获取错误"})},o=function(e,i,o){t.savePassLoading=!1,u.default.showError({vm:t,data:data,errorMsg:"服务器请求失败"})};e.ajax({url:u.default.api.setting.shopInfro.getInfro,type:"POST",dataType:"json",data:function(){return{ssid:r.default.get("ssid")}}()}).done(i).fail(o)}},mounted:function(){this.setBMap()},activated:function(){this.init()}}}).call(t,i(230))},1066:function(e,t){},1110:function(e,t,i){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("Card",[i("p",{attrs:{slot:"title"},slot:"title"},[i("Icon",{attrs:{type:"person"}}),e._v("\n            商铺店铺资料设置\n        ")],1),e._v(" "),i("div",[e.FormSubmiting?i("Spin",{attrs:{fix:""}},[i("Icon",{staticClass:"spin-icon-load",attrs:{type:"load-c",size:"18"}}),e._v(" "),i("div",[e._v("保存中，请稍等...")])],1):e._e(),e._v(" "),i("Form",{ref:"userForm",attrs:{model:e.userForm,"label-width":130,"label-position":"right",rules:e.inforValidate}},[i("FormItem",{attrs:{label:"商户Logo：",prop:"shopLogo"}},[i("noUpFileInput",{attrs:{fileInfro:e.userForm.shop_logo}})],1),e._v(" "),i("FormItem",{attrs:{label:"店铺照片：",prop:"shopImages"}},[e.userForm.isImagesListDataReady?i("multiupload",{attrs:{imagesList:e.userForm.shopImages,uploadAPI:e.uploadAPI,removeAPI:e.removeAPI,uploadModel:e.userForm.shopImages}}):e._e()],1),e._v(" "),i("FormItem",{attrs:{label:"商户位置：",prop:"Point"}},[i("div",{attrs:{id:"r-result"}},[i("Row",[i("Col",{attrs:{span:"10"}},[i("Input",{staticStyle:{position:"relative","z-index":"999","max-width":"600px"},attrs:{type:"text",placeholder:"请输入关键字定位或直接在地图上点击获取坐标","element-id":"suggestId",value:""},model:{value:e.userForm.newPoint.address,callback:function(t){e.$set(e.userForm.newPoint,"address",t)},expression:"userForm.newPoint.address"}}),e._v(" "),i("div",{staticStyle:{"margin-top":"6px"},attrs:{id:"allmap"}})],1),e._v(" "),i("Col",{staticClass:"padding-left-5",attrs:{span:"14"}},[i("div",[i("Tag",[e._v("原位置")]),e._v(" "),i("br"),e._v(" "),i("span",{staticClass:"color-gray "},[e._v("经度：")]),e._v(" "),i("span",{staticClass:"number"},[e._v(e._s(e.userForm.Point.lng))]),e._v(" "),i("span",{staticClass:"color-gray "},[e._v("纬度：")]),e._v(" "),i("span",{staticClass:"number"},[e._v(e._s(e.userForm.Point.lat))])],1),e._v(" "),e.userForm.newPoint.lng>0?i("div",[i("Tag",[e._v("新位置")]),i("Button",{attrs:{size:"small",type:"error"},on:{click:e.clearAddress}},[e._v("清除")]),e._v(" "),i("br"),e._v("\n                                    关键字："),i("span",[e._v(e._s(e.userForm.newPoint.address))]),e._v(" "),i("br"),e._v("\n                                    经度："),i("span",{staticClass:"number color-gray "},[e._v(e._s(e.userForm.newPoint.lng))]),e._v(" \n                                    纬度："),i("span",{staticClass:"number color-gray "},[e._v(e._s(e.userForm.newPoint.lat))])],1):e._e()])],1)],1)]),e._v(" "),i("FormItem",{attrs:{label:"商户简介：",prop:"phone"}},[i("div",{staticStyle:{display:"inline-block",width:"300px"}},[i("Input",{attrs:{type:"textarea",rows:4},model:{value:e.userForm.information,callback:function(t){e.$set(e.userForm,"information",t)},expression:"userForm.information"}})],1)]),e._v(" "),i("div",[i("Button",{staticStyle:{width:"130px"},attrs:{type:"text"},on:{click:e.cancelEditUserInfor}},[e._v("取消")]),e._v(" "),i("Button",{staticStyle:{width:"100px"},attrs:{type:"primary",loading:e.save_loading},on:{click:e.saveEdit}},[e._v("保存")])],1)],1)],1)])],1)},staticRenderFns:[]},e.exports.render._withStripped=!0},990:function(e,t,i){i(1066);var o=i(65)(i(1039),i(1110),null,null);o.options.__file="E:\\BigCousin\\document\\预购宝\\merchant\\src\\views\\settings\\shopinfro.vue",o.esModule&&Object.keys(o.esModule).some(function(e){return"default"!==e&&"__esModule"!==e})&&console.error("named exports are not supported in *.vue files."),o.options.functional&&console.error("[vue-loader] shopinfro.vue: functional components are not supported with templates, they should use render functions."),e.exports=o.exports},996:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"noUpFileInput",data:function(){return{uploadApi:"",imgName:"",newFilePath:"",fileData:"",visible:!1,upLoading:!1,fileType:{image:/\.(gif|jpg|jpeg|png)$/,rar:/\.(rar|zip|7z)$/,txt:/\.(doc|docx|pdf|xsl|xslx|ppt|pptx|txt)$/,music:/\.(mp3|mp4|wma)$/}}},props:["fileInfro"],computed:{FilePath:function(){return this.newFilePath?this.newFilePath:this.fileInfro.url},file_infro:function(){return"Object"==typeof this.fileInfro?{uploadApi:this.fileInfro.uploadApi||this.uploadApi,url:this.fileInfro.url||"",fileObj:this.fileInfro.fileObj||"uploadFile",fileObjName:this.fileInfro.fileObjName||"图片",uploadMenu:this.fileInfro.uploadMenu||"选择图片",uploadType:this.fileInfro.uploadType||"sync",type:this.fileInfro.type||"image",maxSize:this.fileInfro.maxSize?this.fileInfro.maxSize:2048}:{url:"",fileObj:"uploadFile",fileObjName:"图片",uploadMenu:"选择图片",uploadType:"sync",type:"image",maxSize:2048}}},methods:{handleView:function(){this.imgName=this.file_infro.fileObjName,this.visible=!0},selectFile:function(){this.$refs.fileObj.click()},handleFormatError:function(e){this.upLoading=!1,this.$Notice.warning({title:"文件类型错误",desc:"上传文件："+e.name+" 文件类型不正确"})},handleMaxSize:function(e){this.upLoading=!1,this.$Notice.warning({title:"文件过大",desc:"上传文件："+e.name+" 过大，请不要超过"+this.bytesToSize(1024*this.file_infro.maxSize)})},handleGetFile:function(){var e=this.$refs.fileObj.files[0];if(e){var t=e.name.substr(e.name.lastIndexOf(".")).toLowerCase();if(!this.fileType[this.file_infro.type].test(t))return this.handleFormatError(e),!1;if(Math.round(e.size/1024*100)/100>this.file_infro.maxSize)return this.handleMaxSize(e),!1;this.imgName=e.name,this.showPreview(e),this.fileInfro.file=e}},showPreview:function(e){var t=this;if(window.FileReader&&e){var i=new FileReader;i.onloadend=function(e){t.newFilePath=e.target.result},i.readAsDataURL(e)}},bytesToSize:function(e){if(0===e)return"0 B";var t=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,i)).toPrecision(3)+" "+t[i]}}}},997:function(e,t){},998:function(e,t,i){i(997);var o=i(65)(i(996),i(999),null,null);o.options.__file="E:\\BigCousin\\document\\预购宝\\merchant\\src\\views\\my_components\\upload\\noUpFileInput.vue",o.esModule&&Object.keys(o.esModule).some(function(e){return"default"!==e&&"__esModule"!==e})&&console.error("named exports are not supported in *.vue files."),o.options.functional&&console.error("[vue-loader] noUpFileInput.vue: functional components are not supported with templates, they should use render functions."),e.exports=o.exports},999:function(e,t,i){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"noUpFileInput"},[e.FilePath&&"image"==e.fileInfro.type?i("div",{staticClass:"noUpFileInput-filebox"},[i("img",{staticClass:"re-noUpFileInput-images",attrs:{src:e.FilePath,width:"auto",height:"58"},on:{click:function(t){e.handleView()}}})]):e._e(),e._v(" "),i("input",{ref:"fileObj",staticClass:"noup-file-Input",attrs:{type:"file"},on:{change:function(t){e.handleGetFile()}}}),e._v(" "),e.imgName?i("span",{staticClass:"noUpFileInput-newfile-name"},[e._v(e._s(e.imgName))]):e._e(),e._v(" "),i("Button",{attrs:{type:"ghost",icon:"ios-cloud-upload-outline"},on:{click:e.selectFile}},[e._v(e._s(e.file_infro.uploadMenu))]),e._v(" "),i("Modal",{attrs:{title:"图片预览","cancel-text":"关闭"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[e.visible?i("img",{staticStyle:{width:"100%"},attrs:{src:e.FilePath}}):e._e()])],1)},staticRenderFns:[]},e.exports.render._withStripped=!0}});