webpackJsonp([2],{1031:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"upload",data:function(){return{uploadApi:"",imgName:"",newFilePath:"",fileData:"",visible:!1,upLoading:!1}},props:["fileInfro"],computed:{FilePath:function(){return this.newFilePath?this.newFilePath:this.fileInfro.url},file_infro:function(){return this.fileInfro?{uploadApi:this.fileInfro.uploadApi||this.uploadApi,url:this.fileInfro.url||"",fileObj:this.fileInfro.fileObj||"uploadFile",fileObjName:this.fileInfro.fileObjName||"图片",uploadMenu:this.fileInfro.uploadMenu||"选择图片",uploadType:this.fileInfro.uploadType||"sync",type:this.fileInfro.type||"image",maxSize:this.fileInfro.maxSize||0}:{url:"",fileObj:"uploadFile",fileObjName:"图片",uploadMenu:"选择图片",uploadType:"sync",type:"image",maxSize:0}}},methods:{handleView:function(){this.imgName=this.file_infro.fileObjName,this.visible=!0},handleRemove:function(e){var t=this.$refs.upload.fileList;this.$refs.upload.fileList.splice(t.indexOf(e),1)},handleSuccess:function(e,t){this.upLoading=!1},handleError:function(e,t,i){this.upLoading=!1,this.$Notice.warning({title:"上传失败",desc:"上传文件："+t.name+" 失败！请重试。"})},handleFormatError:function(e){this.upLoading=!1,this.$Notice.warning({title:"文件类型错误",desc:"上传文件："+e.name+" 文件类型不正确"})},handleMaxSize:function(e){this.upLoading=!1,this.$Notice.warning({title:"文件过大",desc:"上传文件："+e.name+" 过大，请不要超过"+parseInt(this.file_infro.maxSize/1024)+"MB"})},handleBeforeUpload:function(e){return this.imgName=e.name,this.showPreview(e),"sync"==this.file_infro.uploadType?(this.fileInfro.file=e,!1):(this.upLoading=!0,!0)},showPreview:function(e){var t=this;if(window.FileReader&&e){var i=new FileReader;i.onloadend=function(e){t.newFilePath=e.target.result},i.readAsDataURL(e)}}}}},1040:function(e,t,i){"use strict";(function(e){function a(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=i(154),n=a(r),s=i(100),o=a(s),l=i(229),u=a(l),d=i(998),p=a(d),c=i(1089),f=a(c);t.default={name:"settings-userinfro",components:{upload:f.default,noUpFileInput:p.default},data:function(){return{merchantType:["","商圈","商城"],userForm:{name:"",address:"",businessLicense:{url:"",file:"",fileObj:"file_businessLicense",fileObjName:"营业执照",uploadMenu:"选择图片",uploadType:"sync",type:"image",maxSize:2048},userType:"",rebate:"",phone:"",idCard:"",idCardImage:{url:"",file:"",fileObj:"file_idCardImage",fileObjName:"身份证照片",uploadMenu:"选择图片",uploadType:"sync",type:"image",maxSize:2048},contactor:""},userewm:"",userTypeList:[{value:-1,label:"未知"}],upLoadingBusinessLicense:!1,upLoadingIdCardImage:!1,FormSubmiting:!1,uid:"",save_loading:!1,inforValidate:{name:[{required:!0,message:"请输入商户名称",trigger:"blur"}],address:[{required:!0,message:"请输入商户地址",trigger:"blur"}],phone:[{required:!0,message:"请输入商户电话",trigger:"blur"}],idCard:[{required:!0,message:"请输入商户联系人身份证号码",trigger:"blur"}],contactor:[{required:!0,message:"请输入商户联系人",trigger:"blur"}]}}},methods:{cancelEditUserInfor:function(){this.$store.commit("removeTag","settings-userinfro"),localStorage.pageOpenedList=(0,n.default)(this.$store.state.pageOpenedList);var e="";e=this.$store.state.pageOpenedList.length>1?this.$store.state.pageOpenedList[1].name:this.$store.state.pageOpenedList[0].name,this.$router.push({name:e})},saveEdit:function(){var t=this;this.$refs.userForm.validate(function(i){if(i){var a=new FormData;a.append("ssid",o.default.get("ssid")),a.append("merchantName",t.userForm.name),a.append("merchantPhone",t.userForm.phone),a.append("merchantAddress",t.userForm.address),a.append("applicantName",t.userForm.contactor),a.append("applicantIdCard",t.userForm.idCard),t.userForm.businessLicense.file&&a.append("merchantBusiness",t.userForm.businessLicense.file),t.userForm.idCardImage.file&&a.append("applicantIdCardImage",t.userForm.idCardImage.file),t.FormSubmiting=!0;e.ajax({url:u.default.api.setting.Userinfro.update,type:"POST",dataType:"json",data:a,cache:!1,contentType:!1,processData:!1}).done(function(e){t.FormSubmiting=!1,e?0==e.code?(t.userForm.businessLicense.file="",t.userForm.idCardImage.file="",t.init(),t.$Message.success("成功保存基本信息！")):u.default.showError({vm:t,data:e,errorMsg:""}):u.default.showError({vm:t,data:e,errorMsg:"请求失败"})}).fail(function(e,i,a){t.FormSubmiting=!1,u.default.showError({vm:t,errorMsg:"服务器通讯失败"})})}})},init:function(){var t=this,i=function(e){t.savePassLoading=!1,e?0==e.code?(t.userForm.name=e.data.merchantName,t.userForm.address=e.data.merchantAddress,t.userForm.businessLicense.url=e.data.merchantBusiness,t.userForm.userType=e.data.merchantType,t.userForm.rebate=e.data.merchantRatio,t.userForm.phone=e.data.merchantPhone,t.userForm.idCard=e.data.applicantIdCard,t.userForm.idCardImage.url=e.data.applicantIdCardImage,t.userForm.contactor=e.data.applicantName,t.userForm.applicantStatus=e.data.applicantStatus,t.userForm.merchantCategory=e.data.merchantCategory,t.userForm.merchantType=e.data.merchantType,t.userewm=u.default.api.public.ewm+"&merchantId="+o.default.get("merchant_id")):u.default.showError({vm:t,data:e,errorMsg:"获取基本信息失败"}):u.default.showError({vm:t,data:e,errorMsg:"数据获取错误"})},a=function(e,i,a){t.savePassLoading=!1,u.default.showError({vm:t,data:data,errorMsg:"服务器请求失败"})},r=function(){return{ssid:o.default.get("ssid")}};e.ajax({url:u.default.api.setting.Userinfro.getInfro,type:"POST",dataType:"json",data:r()}).done(i).fail(a),e.ajax({url:u.default.api.public.merchantType,type:"POST",dataType:"json",data:r()}).done(function(e){if(e)if(0==e.code){var i=[];for(var a in e.data)i.push({value:e.data[a].id,label:e.data[a].name});t.userTypeList=i}else u.default.showError({vm:t,data:e,errorMsg:""});else u.default.showError({vm:t,data:e,errorMsg:"获取用户类型失败"})}).fail(function(e,i,a){u.default.showError({vm:t,errorMsg:"获取用户类型失败"})})}},created:function(){},mounted:function(){},activated:function(){this.init()}}}).call(t,i(230))},1049:function(e,t){},1057:function(e,t){},1089:function(e,t,i){i(1049);var a=i(65)(i(1031),i(1124),null,null);a.options.__file="E:\\BigCousin\\document\\预购宝\\merchant\\src\\views\\my_components\\upload\\upload.vue",a.esModule&&Object.keys(a.esModule).some(function(e){return"default"!==e&&"__esModule"!==e})&&console.error("named exports are not supported in *.vue files."),a.options.functional&&console.error("[vue-loader] upload.vue: functional components are not supported with templates, they should use render functions."),e.exports=a.exports},1098:function(e,t,i){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",[i("Card",[i("p",{attrs:{slot:"title"},slot:"title"},[i("Icon",{attrs:{type:"person"}}),e._v("\n            基本信息设置\n        ")],1),e._v(" "),i("div",[e.FormSubmiting?i("Spin",{attrs:{fix:""}},[i("Icon",{staticClass:"spin-icon-load",attrs:{type:"load-c",size:"18"}}),e._v(" "),i("div",[e._v("保存中，请稍等...")])],1):e._e(),e._v(" "),i("Form",{ref:"userForm",attrs:{model:e.userForm,"label-width":130,"label-position":"right",rules:e.inforValidate}},[i("FormItem",{attrs:{label:"商户名称：",prop:"name"}},[i("div",{staticStyle:{display:"inline-block",width:"300px"}},[i("Input",{model:{value:e.userForm.name,callback:function(t){e.$set(e.userForm,"name",t)},expression:"userForm.name"}})],1)]),e._v(" "),i("FormItem",{attrs:{label:"审核状态："}},[i("div",{staticStyle:{display:"inline-block",width:"300px"}},[1==e.userForm.applicantStatus?[i("span",{staticStyle:{color:"green"}},[e._v("已通过")])]:2==e.userForm.applicantStatus?[i("span",{staticStyle:{color:"red"}},[e._v("未通过")])]:[i("span",{staticStyle:{color:"gray"}},[e._v("审核中")])]],2)]),e._v(" "),i("FormItem",{attrs:{label:"商户地址：",prop:"address"}},[i("div",{staticStyle:{display:"inline-block",width:"300px"}},[i("Input",{model:{value:e.userForm.address,callback:function(t){e.$set(e.userForm,"address",t)},expression:"userForm.address"}})],1)]),e._v(" "),i("FormItem",{attrs:{label:"商户面积：",prop:"address"}},[i("div",{staticStyle:{display:"inline-block",width:"300px"}},[e._v("\n                         "+e._s(e.userForm.merchantOperatingArea)+"\n                    ")])]),e._v(" "),i("FormItem",{attrs:{label:"营业执照：",prop:"businessLicense"}},[i("noUpFileInput",{attrs:{fileInfro:e.userForm.businessLicense}})],1),e._v(" "),i("FormItem",{attrs:{label:"商户类型："}},[i("div",{staticStyle:{display:"inline-block",width:"300px"}},[e._v("\n                        "+e._s(e.merchantType[e.userForm.merchantType])+"\n                    ")])]),e._v(" "),i("FormItem",{attrs:{label:"商户分类："}},[i("div",{staticStyle:{display:"inline-block",width:"300px"}},[e._v("\n                        "+e._s(e.userForm.merchantCategory)+"\n                    ")])]),e._v(" "),i("FormItem",{attrs:{label:"商户折扣差：",prop:"rebate"}},[i("div",{staticStyle:{display:"inline-block",width:"300px"}},[i("span",{staticClass:"number color-blue"},[e._v(e._s(100*e.userForm.rebate)+"%")])])]),e._v(" "),i("FormItem",{attrs:{label:"联系人姓名：",prop:"contactor"}},[i("div",{staticStyle:{display:"inline-block",width:"300px"}},[i("Input",{model:{value:e.userForm.contactor,callback:function(t){e.$set(e.userForm,"contactor",t)},expression:"userForm.contactor"}})],1)]),e._v(" "),i("FormItem",{attrs:{label:"商户电话：",prop:"phone"}},[i("div",{staticStyle:{display:"inline-block",width:"300px"}},[i("Input",{model:{value:e.userForm.phone,callback:function(t){e.$set(e.userForm,"phone",t)},expression:"userForm.phone"}})],1)]),e._v(" "),i("FormItem",{attrs:{label:"联系人身份证号码：",prop:"idCard"}},[i("div",{staticStyle:{display:"inline-block",width:"300px"}},[i("Input",{model:{value:e.userForm.idCard,callback:function(t){e.$set(e.userForm,"idCard",t)},expression:"userForm.idCard"}})],1)]),e._v(" "),i("FormItem",{attrs:{label:"联系人身份证照片：",prop:"idCardImage"}},[i("noUpFileInput",{attrs:{fileInfro:e.userForm.idCardImage}})],1),e._v(" "),i("div",[i("Button",{staticStyle:{width:"130px"},attrs:{type:"text"},on:{click:e.cancelEditUserInfor}},[e._v("取消")]),e._v(" "),i("Button",{staticStyle:{width:"100px"},attrs:{type:"primary",loading:e.save_loading},on:{click:e.saveEdit}},[e._v("保存")])],1),e._v(" "),1==e.userForm.applicantStatus?i("div",{staticClass:"shop-ewm"},[i("a",{attrs:{href:e.userewm,target:"blank"}},[i("img",{attrs:{src:e.userewm}})]),i("br"),e._v("点击右键选择图片另存为"),i("br"),e._v("即可下载二维码")]):e._e()],1)],1)])],1)},staticRenderFns:[]},e.exports.render._withStripped=!0},1124:function(e,t,i){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"singleUpload"},[e.FilePath?i("div",{staticClass:"upload-filebox"},[i("img",{staticClass:"re-upload-images",attrs:{src:e.FilePath,width:"auto",height:"58"},on:{click:function(t){e.handleView()}}}),e._v(" "),e.upLoading?i("Spin",{staticClass:"spin-uploading",attrs:{size:"large",fix:""}},[i("Icon",{staticClass:"spin-icon-load",attrs:{type:"load-c",size:"18"}}),e._v(" "),i("span",[e._v("上传中...")])],1):e._e()],1):e._e(),e._v(" "),i("Upload",{staticClass:"upload-singleUpload",attrs:{"before-upload":e.handleBeforeUpload,"on-format-error":e.handleFormatError,"on-exceeded-size":e.handleMaxSize,"on-success":e.handleSuccess,"on-error":e.handleError,action:e.uploadApi,"show-upload-list":!1,format:["jpg","jpeg","png"],"max-size":e.file_infro.maxSize}},[i("Button",{attrs:{type:"ghost",icon:"ios-cloud-upload-outline"}},[e._v(e._s(e.file_infro.uploadMenu))])],1),e._v(" "),i("span",{staticClass:"upload-newfile-name"},[e._v(e._s(e.imgName))]),e._v(" "),i("Modal",{attrs:{title:"图片预览","cancel-text":"关闭"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[e.visible?i("img",{staticStyle:{width:"100%"},attrs:{src:e.FilePath}}):e._e()])],1)},staticRenderFns:[]},e.exports.render._withStripped=!0},991:function(e,t,i){i(1057);var a=i(65)(i(1040),i(1098),null,null);a.options.__file="E:\\BigCousin\\document\\预购宝\\merchant\\src\\views\\settings\\userinfro.vue",a.esModule&&Object.keys(a.esModule).some(function(e){return"default"!==e&&"__esModule"!==e})&&console.error("named exports are not supported in *.vue files."),a.options.functional&&console.error("[vue-loader] userinfro.vue: functional components are not supported with templates, they should use render functions."),e.exports=a.exports},996:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={name:"noUpFileInput",data:function(){return{uploadApi:"",imgName:"",newFilePath:"",fileData:"",visible:!1,upLoading:!1,fileType:{image:/\.(gif|jpg|jpeg|png)$/,rar:/\.(rar|zip|7z)$/,txt:/\.(doc|docx|pdf|xsl|xslx|ppt|pptx|txt)$/,music:/\.(mp3|mp4|wma)$/}}},props:["fileInfro"],computed:{FilePath:function(){return this.newFilePath?this.newFilePath:this.fileInfro.url},file_infro:function(){return"Object"==typeof this.fileInfro?{uploadApi:this.fileInfro.uploadApi||this.uploadApi,url:this.fileInfro.url||"",fileObj:this.fileInfro.fileObj||"uploadFile",fileObjName:this.fileInfro.fileObjName||"图片",uploadMenu:this.fileInfro.uploadMenu||"选择图片",uploadType:this.fileInfro.uploadType||"sync",type:this.fileInfro.type||"image",maxSize:this.fileInfro.maxSize?this.fileInfro.maxSize:2048}:{url:"",fileObj:"uploadFile",fileObjName:"图片",uploadMenu:"选择图片",uploadType:"sync",type:"image",maxSize:2048}}},methods:{handleView:function(){this.imgName=this.file_infro.fileObjName,this.visible=!0},selectFile:function(){this.$refs.fileObj.click()},handleFormatError:function(e){this.upLoading=!1,this.$Notice.warning({title:"文件类型错误",desc:"上传文件："+e.name+" 文件类型不正确"})},handleMaxSize:function(e){this.upLoading=!1,this.$Notice.warning({title:"文件过大",desc:"上传文件："+e.name+" 过大，请不要超过"+this.bytesToSize(1024*this.file_infro.maxSize)})},handleGetFile:function(){var e=this.$refs.fileObj.files[0];if(e){var t=e.name.substr(e.name.lastIndexOf(".")).toLowerCase();if(!this.fileType[this.file_infro.type].test(t))return this.handleFormatError(e),!1;if(Math.round(e.size/1024*100)/100>this.file_infro.maxSize)return this.handleMaxSize(e),!1;this.imgName=e.name,this.showPreview(e),this.fileInfro.file=e}},showPreview:function(e){var t=this;if(window.FileReader&&e){var i=new FileReader;i.onloadend=function(e){t.newFilePath=e.target.result},i.readAsDataURL(e)}},bytesToSize:function(e){if(0===e)return"0 B";var t=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,i)).toPrecision(3)+" "+t[i]}}}},997:function(e,t){},998:function(e,t,i){i(997);var a=i(65)(i(996),i(999),null,null);a.options.__file="E:\\BigCousin\\document\\预购宝\\merchant\\src\\views\\my_components\\upload\\noUpFileInput.vue",a.esModule&&Object.keys(a.esModule).some(function(e){return"default"!==e&&"__esModule"!==e})&&console.error("named exports are not supported in *.vue files."),a.options.functional&&console.error("[vue-loader] noUpFileInput.vue: functional components are not supported with templates, they should use render functions."),e.exports=a.exports},999:function(e,t,i){e.exports={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"noUpFileInput"},[e.FilePath&&"image"==e.fileInfro.type?i("div",{staticClass:"noUpFileInput-filebox"},[i("img",{staticClass:"re-noUpFileInput-images",attrs:{src:e.FilePath,width:"auto",height:"58"},on:{click:function(t){e.handleView()}}})]):e._e(),e._v(" "),i("input",{ref:"fileObj",staticClass:"noup-file-Input",attrs:{type:"file"},on:{change:function(t){e.handleGetFile()}}}),e._v(" "),e.imgName?i("span",{staticClass:"noUpFileInput-newfile-name"},[e._v(e._s(e.imgName))]):e._e(),e._v(" "),i("Button",{attrs:{type:"ghost",icon:"ios-cloud-upload-outline"},on:{click:e.selectFile}},[e._v(e._s(e.file_infro.uploadMenu))]),e._v(" "),i("Modal",{attrs:{title:"图片预览","cancel-text":"关闭"},model:{value:e.visible,callback:function(t){e.visible=t},expression:"visible"}},[e.visible?i("img",{staticStyle:{width:"100%"},attrs:{src:e.FilePath}}):e._e()])],1)},staticRenderFns:[]},e.exports.render._withStripped=!0}});