webpackJsonp([4],{1001:function(t,e,a){t.exports={default:a(1002),__esModule:!0}},1002:function(t,e,a){a(1004),t.exports=a(66).Number.isInteger},1003:function(t,e,a){var s=a(118),i=Math.floor;t.exports=function(t){return!s(t)&&isFinite(t)&&i(t)===t}},1004:function(t,e,a){var s=a(117);s(s.S,"Number",{isInteger:a(1003)})},1028:function(t,e,a){"use strict";(function(t){function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var i=a(154),d=s(i),o=a(1001),n=(s(o),a(229)),r=s(n),l=a(116),c=s(l),u=a(100),h=s(u);e.default={name:"specs-list",data:function(){return{specs_list:[],saveType:"new",page:{dataCount:0,pageCount:0,pageSize:10,pageNumber:1,pageSizeOpts:[10,20,50,100]},currentData:{id:"",name:""},currentChildData:{id:"",option_id:"",name:""},getLoading:!1,getChildLoading:!1,save_loading:!1,searchData:{searchDate:[],startDate:"",endDate:""},searchValidata:{},specsForm:{id:"",name:""},childsData:[],editSpecsModal:!1,editChildsModal:!1,cashLoading:!1,cashInfroData:{id:"",option_id:"",name:""},specsEditType:"edit",childEditType:"add",childFormValidata:{name:[{required:!0,message:"请输入规格属性名称",trigger:"blur"}]},specsFormValidata:{name:[{required:!0,message:"请输入规格名称",trigger:"blur"}]}}},methods:{changePage:function(t){this.page.pageNumber=t,this.search()},changePageSize:function(t){this.page.pageSize=t,this.page.pageCount=Math.ceil(this.page.dataCount/this.page.pageSize),this.search()},search:function(){this.searchData.searchDate.length&&(this.searchData.startDate=c.default.FormatDate(this.searchData.searchDate[0],"yyyy-MM-dd"),this.searchData.endDate=c.default.FormatDate(this.searchData.searchDate[1],"yyyy-MM-dd")),this.init()},addSpecs:function(){this.currentData={name:""},this.specsEditType="add",this.editSpecsModal=!0},editSpecs:function(e){this.currentData={},this.currentData=t.extend(!0,{},this.specs_list[e]),this.specsEditType="edit",this.editSpecsModal=!0},cancelEditSpecs:function(){this.editSpecsModal=!1},saveEditSpecs:function(){var e=this;this.$refs.specsForm.validate(function(a){if(a){e.save_loading=!0;var s={ssid:h.default.get("ssid"),name:e.currentData.name};"edit"==e.specsEditType&&(s.option_id=e.currentData.id),t.ajax({url:"edit"==e.specsEditType?r.default.api.mall.specs.edit:r.default.api.mall.specs.add,type:"POST",dataType:"json",data:s}).done(function(t){e.save_loading=!1,t?0==t.code?(e.$Message.success("规格保存成功"),e.init(),e.cancelEditSpecs()):r.default.showError({vm:e,data:t,errorMsg:""}):r.default.showError({vm:e,data:t,errorMsg:"请求失败"})}).fail(function(t,a,s){e.save_loading=!1,r.default.showError({vm:e,errorMsg:"服务器通讯失败"})})}}),this.editSpecsModal=!1},deleteSpecs:function(e){console.log(e);var a=this;this.$Modal.confirm({title:"系统提示",content:"确定要删除此规格吗？删除规格可能影响到已上架商品。",onOk:function(){a.save_loading=!0;var s={ssid:h.default.get("ssid"),option_id:a.specs_list[e].id};t.ajax({url:r.default.api.mall.specs.delete,type:"POST",dataType:"json",data:s}).done(function(t){a.save_loading=!1,t?0==t.code?(a.$Message.success("删除成功"),a.init(),a.cancelEditSpecs()):r.default.showError({vm:a,data:t,errorMsg:""}):r.default.showError({vm:a,data:t,errorMsg:"请求失败"})}).fail(function(t,e,s){a.save_loading=!1,r.default.showError({vm:a,errorMsg:"服务器通讯失败"})})},onCancel:function(){}})},showchilds:function(t){this.currentData=this.specs_list[t],this.childsData=[],this.getChilds(),this.childEditType="add",this.editChildsModal=!0},editChilds:function(e){this.currentChildData=t.extend(!0,{},this.childsData[e]),this.currentChildData.dataIndex=e,this.childEditType="edit",this.editChildsModal=!0},cancelChilds:function(){this.editChildsModal=!1},cancelEditChilds:function(){this.currentChildData={id:"",option_id:"",name:""},this.childEditType="add"},saveEditChilds:function(){var e=this;this.$refs.childForm.validate(function(a){if(a){e.save_loading=!0;var s=[],i=r.default.api.mall.specs.editchild;if("edit"==e.childEditType)for(var o=0;o<e.childsData.length;o++)o===e.currentChildData.dataIndex?s.push({name:e.currentChildData.name}):s.push({name:e.childsData[o].name});"add"==e.childEditType&&(i=r.default.api.mall.specs.addchild,s=[{name:e.currentChildData.name}]);var n=(0,d.default)(s),l={ssid:h.default.get("ssid"),option_id:e.currentData.id,data:'{"data":'+n+"}"};e.cancelEditChilds(),t.ajax({url:i,type:"POST",dataType:"json",data:l}).done(function(t){e.save_loading=!1,t?0==t.code?(e.$Message.success("规格属性保存成功"),e.getChilds()):r.default.showError({vm:e,data:t,errorMsg:""}):r.default.showError({vm:e,data:t,errorMsg:"请求失败"})}).fail(function(t,a,s){e.save_loading=!1,r.default.showError({vm:e,errorMsg:"服务器通讯失败"})})}})},deleteChilds:function(e){var a=this;console.log(e),this.$Modal.confirm({title:"系统提示",content:"确定要删除此属性吗？删除规格属性可能影响到已上架商品。",onOk:function(){var s=[],i=r.default.api.mall.specs.deletechild;a.getChildLoading=!0,s.push({name:a.childsData[e].name});var o=(0,d.default)(s),n={ssid:h.default.get("ssid"),attributeId:a.childsData[e].id,option_id:a.currentData.id,data:'{"data":'+o+"}"};t.ajax({url:i,type:"POST",dataType:"json",data:n}).done(function(t){a.getChildLoading=!1,t?0==t.code?(a.$Message.success("规格属性删除成功"),a.getChilds()):r.default.showError({vm:a,data:t,errorMsg:""}):r.default.showError({vm:a,data:t,errorMsg:"请求失败"})}).fail(function(t,e,s){a.getChildLoading=!1,r.default.showError({vm:a,errorMsg:"服务器通讯失败"})})},onCancel:function(){}})},init:function(){var e=this,a={ssid:h.default.get("ssid")};this.getLoading=!0,t.ajax({url:r.default.api.mall.specs.list,type:"POST",dataType:"json",data:a}).done(function(t){e.getLoading=!1,t?0==t.code?e.specs_list=t.data.list:r.default.showError({vm:e,data:t,errorMsg:""}):r.default.showError({vm:e,data:t,errorMsg:"请求失败"})}).fail(function(t,a,s){e.getLoading=!1,r.default.showError({vm:e,errorMsg:"服务器通讯失败"})})},getChilds:function(){var e=this,a={ssid:h.default.get("ssid"),option_id:this.currentData.id};this.getChildLoading=!0,t.ajax({url:r.default.api.mall.specs.childList,type:"POST",dataType:"json",data:a}).done(function(t){e.getChildLoading=!1,t?0==t.code?""!==t.data&&(e.childsData=t.data):r.default.showError({vm:e,data:t,errorMsg:""}):r.default.showError({vm:e,data:t,errorMsg:"请求失败"})}).fail(function(t,a,s){e.getChildLoading=!1,r.default.showError({vm:e,errorMsg:"服务器通讯失败"})})}},updated:function(){this.$nextTick(function(){})},mounted:function(){},activated:function(){this.init()}}}).call(e,a(230))},1056:function(t,e){},1097:function(t,e,a){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Card",[a("p",{staticClass:"hasButtonP",attrs:{slot:"title"},slot:"title"},[a("Icon",{attrs:{type:"person"}}),t._v("\n            商品规格管理 \n            "),a("Button",{staticClass:"add-btu",attrs:{type:"primary",size:"small"},on:{click:t.addSpecs}},[t._v("添加规格\n            ")])],1),t._v(" "),a("div",{staticClass:"ordler-list"},[t.specs_list.length>0?[a("div",{staticClass:"specs-list-warp"},[t._l(t.specs_list,function(e,s){return[a("ButtonGroup",{staticClass:"specs-item"},[a("Button",{on:{click:function(e){t.showchilds(s)}}},[t._v(t._s(e.name))]),t._v(" "),a("Button",{staticClass:"smallbutton",attrs:{type:"dashed"},on:{click:function(e){t.editSpecs(s)}}},[a("Icon",{attrs:{type:"edit"}})],1),t._v(" "),a("Button",{staticClass:"smallbutton",attrs:{type:"dashed"},on:{click:function(e){t.deleteSpecs(s)}}},[a("Icon",{attrs:{type:"close"}})],1)],1)]})],2)]:[t._v("\n                暂时没有添加规格\n            ")]],2),t._v(" "),a("Modal",{attrs:{"class-name":"vertical-center-modal nofootmodel",closable:!1,"mask-closable":!1,width:500},model:{value:t.editSpecsModal,callback:function(e){t.editSpecsModal=e},expression:"editSpecsModal"}},[a("h3",{staticStyle:{color:"#2D8CF0"},attrs:{slot:"header"},slot:"header"},[t._v(t._s("add"==t.specsEditType?"添加格规":"修改规格"))]),t._v(" "),a("Form",{ref:"specsForm",attrs:{autocomplete:"off",model:t.currentData,"label-width":0,rules:t.specsFormValidata}},[a("FormItem",{attrs:{prop:"name"}},[a("Input",{attrs:{placeholder:"请输入新格规名称"},model:{value:t.currentData.name,callback:function(e){t.$set(t.currentData,"name",e)},expression:"currentData.name"}},[a("Icon",{attrs:{slot:"prepend",type:"plus"},slot:"prepend"})],1)],1)],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary",loading:t.save_loading},on:{click:t.saveEditSpecs}},[t._v("保存")]),t._v(" "),a("Button",{attrs:{type:"primary"},on:{click:t.cancelEditSpecs}},[t._v("关闭")])],1)],1),t._v(" "),a("Modal",{attrs:{"class-name":"vertical-center-modal nofootmodel",closable:!1,"mask-closable":!1,width:600},model:{value:t.editChildsModal,callback:function(e){t.editChildsModal=e},expression:"editChildsModal"}},[t.getChildLoading?a("Spin",{attrs:{size:"large",fix:""}}):t._e(),t._v(" "),a("h3",{staticStyle:{color:"#2D8CF0"},attrs:{slot:"header"},slot:"header"},[t._v("规格属性列表 - "+t._s(t.currentData.name))]),t._v(" "),a("div",{staticClass:"specs-child-list"},[t.childsData.length>0?[t._l(t.childsData,function(e,s){return[a("ButtonGroup",{staticClass:"specs-item"},[a("Button",[t._v(t._s(e.name))]),t._v(" "),a("Button",{staticClass:"smallbutton",on:{click:function(e){t.deleteChilds(s)}}},[a("Icon",{attrs:{type:"close"}})],1)],1)]})]:[a("div",{staticStyle:{"padding-bottom":"15px"}},[t._v("暂时没有添加规格")])]],2),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Form",{ref:"childForm",staticStyle:{float:"left"},attrs:{autocomplete:"off",model:t.currentChildData,"label-width":0,inline:"","label-position":"right",rules:t.childFormValidata}},[a("FormItem",{attrs:{prop:"cashMoney"}},[a("Input",{attrs:{placeholder:"请输入新属性名称"},model:{value:t.currentChildData.name,callback:function(e){t.$set(t.currentChildData,"name",e)},expression:"currentChildData.name"}},["add"==t.childEditType?a("Icon",{attrs:{slot:"prepend",type:"plus"},slot:"prepend"}):a("Icon",{attrs:{slot:"prepend",type:"settings"},slot:"prepend"})],1)],1),t._v(" "),a("FormItem",[a("Button",{attrs:{type:"info",loading:t.save_loading},on:{click:t.saveEditChilds}},[t._v("保存")]),t._v(" "),a("Button",{attrs:{type:"default"},on:{click:t.cancelEditChilds}},[t._v("取消")])],1)],1),t._v(" "),a("Button",{attrs:{type:"primary"},on:{click:t.cancelChilds}},[t._v("关闭")])],1)],1)],1)],1)},staticRenderFns:[]},t.exports.render._withStripped=!0},981:function(t,e,a){a(1056);var s=a(65)(a(1028),a(1097),null,null);s.options.__file="E:\\BigCousin\\document\\预购宝\\merchant\\src\\views\\mall\\specs.vue",s.esModule&&Object.keys(s.esModule).some(function(t){return"default"!==t&&"__esModule"!==t})&&console.error("named exports are not supported in *.vue files."),s.options.functional&&console.error("[vue-loader] specs.vue: functional components are not supported with templates, they should use render functions."),t.exports=s.exports}});