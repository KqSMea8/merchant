webpackJsonp([18],{1029:function(t,e,a){"use strict";(function(t){function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var r=a(154),i=s(r),o=a(229),d=s(o),n=a(116),l=s(n),u=a(100),c=s(u);e.default={name:"list",data:function(){var t=this;return{value:"",modal2:!1,columns:[{title:"帐号",key:"name"},{title:"手机",key:"mobile"},{title:"创建时间",align:"center",key:"created"},{title:"购物积分",key:"shopping_score"},{title:"白积分",key:"white_score"},{title:"红积分",key:"red_score"},{title:"等级",key:"level",align:"center",render:function(t,e){var a="";return 0==e.row.level&&(a="普通会员"),1==e.row.level&&(a="分享合伙人"),2==e.row.level&&(a="事业合伙人"),t("span",{},a)}},{title:"操作",key:"action",width:130,align:"center",render:function(e,a){var s=e("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){t.doWhat("edit",a.index)}}},"添加白积分"),r=(e("Button",{props:{type:"error",size:"small"},on:{click:function(){t.doWhat("delete",a.index)}}},"删除"),[]);return r.push(s),e("div",r)}}],saveType:"new",doType:"list",switching:!1,tableData:[],groupData:[],page:{dataCount:0,pageCount:0,pageSize:10,pageNumber:1,pageSizeOpts:[10,20,50,100]},dataReady:0,currentData:{},currentDatas:{password:"",whiteScore:"",id:""},addDataValidate:{id:[{required:!0,message:"请输入会员ID",trigger:"blur"}],password:[{required:!0,message:"请输入店长密码",trigger:"blur"}],whiteScore:[{required:!0,message:"请输入白积分",trigger:"blur"}]},searchData:{keyword:"",searchDate:[],startDate:"",endDate:""},searchValidata:{}}},computed:{getLoading:function(){return!(0==this.dataReady)},doName:function(){return"list"==this.doType?"后台管理账户":"edit"==this.doType?"编辑账户":"添加账户"},currentDataValidate:function(){return this.addDataValidate},currentDataValidates:function(){return"add"==this.doType?this.addDataValidate:this.editDataValidate},hasDataChange:function(){return!((0,i.default)(this.currentData)==(0,i.default)(this.tableData[this.currentData.listIndex]))}},methods:{close:function(){this.modal2=!1,this.value=""},doWhat:function(t,e){this.switching=!0,"add"==t&&(this.resetCurrentData(),this.doType="add"),"edit"==t&&(this.showEdit(e),this.modal2=!0),"delete"==t&&this.delete(e),"list"==t&&(this.resetCurrentData(),this.dataReady+=2,this.init(),this.doType="list"),this.switching=!1},showEdit:function(e){this.currentData=t.extend(!0,{},this.tableData[e])},resetCurrentData:function(){this.currentData=t.extend(!0,{},this.defaultData)},changePage:function(t){this.page.pageNumber=t,this.search(t)},changePageSize:function(t){this.page.pageSize=t,this.page.pageCount=Math.ceil(this.page.dataCount/this.page.pageSize),this.search()},resetSearch:function(){this.searchData={keyword:"",searchDate:[],startDate:"",endDate:""},this.page.pageNumber=1,this.dataReady+=1,this.init()},search:function(t){this.searchData.searchDate.length&&(this.searchData.startDate=l.default.FormatDate(this.searchData.searchDate[0],"yyyy-MM-dd"),this.searchData.endDate=l.default.FormatDate(this.searchData.searchDate[1],"yyyy-MM-dd")),this.page.pageNumber=1,t&&(this.page.pageNumber=t),this.doWhat("list")},init:function(){this.getList()},getList:function(){var e=this;if(1!=c.default.get("is_direct"))return this.$Message.warning("对不起，您没有此操作权限！"),!1;var a={ssid:c.default.get("ssid"),page:this.page.pageNumber,pageSize:this.page.pageSize};""!=this.searchData.keyword&&(a.mobile=this.searchData.keyword),t.ajax({url:d.default.api.member.list,type:"POST",dataType:"json",data:a}).done(function(t){e.dataReady--,t?0==t.code?(e.page.dataCount=t.data.count,e.page.pageCount=Math.ceil(e.page.dataCount/e.page.pageSize),e.tableData=t.data.list):d.default.showError({vm:e,data:t,errorMsg:""}):d.default.showError({vm:e,data:t,errorMsg:"请求失败"})}).fail(function(t,a,s){e.dataReady--,d.default.showError({vm:e,errorMsg:"服务器通讯失败"})})},getGroups:function(){var e=this,a={ssid:c.default.get("ssid")};t.ajax({url:d.default.apiRootPath+d.default.api.member.list,type:"POST",dataType:"json",data:a}).done(function(t){e.dataReady--,t?0==t.code?e.groupData=t.data.list:d.default.showError({vm:e,data:t,errorMsg:""}):d.default.showError({vm:e,data:t,errorMsg:"请求失败"})}).fail(function(t,a,s){e.dataReady--,d.default.showError({vm:e,errorMsg:"服务器通讯失败"})})},saveEdit:function(){var e=this,a={ssid:c.default.get("ssid"),id:this.currentData.id,amount:this.value};t.ajax({url:d.default.api.member.addmemberwhitescore,type:"POST",dataType:"json",data:a}).done(function(t){0==t.code?(e.$Message.success(t.message),e.modal2=!1,e.value="",e.doWhat("list")):d.default.showError({vm:e,data:t,errorMsg:""})}).fail(function(t,a,s){d.default.showError({vm:e,errorMsg:"服务器通讯失败"})})},showEditPassword:function(t){t&&(this.editPasswordForm.userid=t,this.editPasswordModal=!0)},cancelEditPass:function(){this.editPasswordForm.userid="",this.editPasswordForm.oldPass="",this.editPasswordForm.newPass="",this.editPasswordForm.rePass="",this.editPasswordModal=!1},saveEditPass:function(){var e=this;this.$refs.editPasswordForm.validate(function(a){if(a){e.savePassLoading=!0;var s={ssid:c.default.get("ssid"),id:e.editPasswordForm.userid,password:e.editPasswordForm.oldPass,new_password:e.editPasswordForm.newPass,ok_new_password:e.editPasswordForm.rePass};t.ajax({url:d.default.apiRootPath+d.default.api.system.admin_assignments.modifyPassword,type:"POST",dataType:"json",data:s}).done(function(t){e.savePassLoading=!1,t?0==t.code?(e.$Message.success("修改密码成功！"),e.editPasswordForm.oldPass="",e.editPasswordForm.newPass="",e.editPasswordForm.rePass="",e.editPasswordForm.userid="",e.editPasswordModal=!1):d.default.showError({vm:e,data:t,errorMsg:""}):d.default.showError({vm:e,data:t,errorMsg:"请求失败"})}).fail(function(t,a,s){e.savePassLoading=!1,d.default.showError({vm:e,data:data,errorMsg:"服务器通讯失败"})})}})},delete:function(e){var a=this;if(this.tableData[e].id){t.ajax({url:d.default.apiRootPath+d.default.api.system.admin_assignments.delete,type:"POST",dataType:"json",data:function(){return{ssid:c.default.get("ssid"),id:a.tableData[e].id,status:0}}()}).done(function(t){t?0==t.code?(a.$Message.success("删除成功!"),a.tableData.splice(e,1)):d.default.showError({vm:a,data:t,errorMsg:""}):d.default.showError({vm:a,data:t,errorMsg:"请求失败"})}).fail(function(t,e,s){d.default.showError({vm:a,errorMsg:"服务器通讯失败"})})}}},mounted:function(){},activated:function(){this.doWhat("list")}}}).call(e,a(230))},1072:function(t,e){},1117:function(t,e,a){t.exports={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("Card",[a("p",{staticClass:"hasButtonP",attrs:{slot:"title"},slot:"title"},[a("Icon",{attrs:{type:"person"}}),t._v("\n            会员管理\n           ")],1),t._v(" "),a("div",{staticClass:"doBox"},[t.switching?a("Spin",{attrs:{size:"large",fix:""}}):t._e(),t._v(" "),"list"!=t.doType?a("div",[a("Form",{ref:"currentDatas",attrs:{model:t.currentDatas,"label-width":100,"label-position":"right",rules:t.addDataValidate}},[a("FormItem",{attrs:{label:"白积分：",prop:"whiteScore"}},[a("div",{staticStyle:{display:"inline-block",width:"404px"}},[a("Input",{model:{value:t.currentDatas.whiteScore,callback:function(e){t.$set(t.currentDatas,"whiteScore",e)},expression:"currentDatas.whiteScore"}})],1)]),t._v(" "),a("div",[a("Button",{staticStyle:{width:"100px"},attrs:{type:"text"},on:{click:function(e){t.doWhat("list")}}},[t._v("取消")]),t._v(" "),a("Button",{staticStyle:{width:"100px"},attrs:{type:"primary"},on:{click:t.saveEdit}},[t._v("保存")])],1)],1)],1):t._e(),t._v(" "),"list"==t.doType?a("div",{staticClass:"ordler-list"},[a("div",{staticClass:"search-box"},[a("Form",{ref:"searchData",attrs:{model:t.searchData,rules:t.searchValidata,inline:""}},[a("FormItem",{attrs:{prop:"keyword"}},[a("Input",{attrs:{type:"text",placeholder:"输入名称搜索电话号码"},model:{value:t.searchData.keyword,callback:function(e){t.$set(t.searchData,"keyword",e)},expression:"searchData.keyword"}},[a("Icon",{attrs:{slot:"prepend",type:"ios-eye"},slot:"prepend"})],1)],1),t._v(" "),a("FormItem",[a("Button",{attrs:{type:"primary",icon:"search"},on:{click:function(e){t.search()}}},[t._v("搜索")])],1)],1)],1),t._v(" "),a("Table",{attrs:{border:"",columns:t.columns,data:t.tableData}}),t._v(" "),a("div",{staticClass:"page-box"},[t.page.pageCount>1?a("Page",{attrs:{total:t.page.dataCount,current:t.page.pageNumber,"show-total":"","page-size-opts":t.page.pageSizeOpts,"page-size":t.page.pageSize,"show-elevator":"",placement:"top","show-sizer":""},on:{"on-change":t.changePage,"on-page-size-change":t.changePageSize}}):t._e()],1)],1):t._e()],1)]),t._v(" "),a("Modal",{attrs:{width:"700"},model:{value:t.modal2,callback:function(e){t.modal2=e},expression:"modal2"}},[a("p",{attrs:{slot:"header"},slot:"header"},[a("span",[t._v("添加")])]),t._v(" "),a("div",{staticStyle:{"text-align":"center"}},[a("span",[t._v("消费金额：")]),t._v(" "),a("Input",{staticStyle:{width:"500px"},attrs:{placeholder:"请输入消费金额"},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}}),t._v(" "),a("span",{staticStyle:{color:"red"}},[t._v("金额："+t._s(""==t.value?0:t.value)+"元")])],1),t._v(" "),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"default"},on:{click:t.close}},[t._v("取消")]),t._v(" "),a("Button",{attrs:{type:"success"},on:{click:t.saveEdit}},[t._v("保存")])],1)])],1)},staticRenderFns:[]},t.exports.render._withStripped=!0},982:function(t,e,a){a(1072);var s=a(65)(a(1029),a(1117),null,null);s.options.__file="E:\\BigCousin\\document\\预购宝\\merchant\\src\\views\\menber\\list.vue",s.esModule&&Object.keys(s.esModule).some(function(t){return"default"!==t&&"__esModule"!==t})&&console.error("named exports are not supported in *.vue files."),s.options.functional&&console.error("[vue-loader] list.vue: functional components are not supported with templates, they should use render functions."),t.exports=s.exports}});